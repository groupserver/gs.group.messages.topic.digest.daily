<tal:block
  define=" groupName options/groupName | view/groupInfo/name;
          topicsDigest options/topicsDigest | view/topicsDigest;
          np python:topicsDigest.post_stats['new_posts'];
          et python:topicsDigest.post_stats['existing_topics'];
          nt python:topicsDigest.post_stats['new_topics'];
          munge_date python:modules['Products.XWFCore.XWFUtils'].munge_date">
  <p tal:define="singular python:np==1;">
    This is your daily digest of posts made to
    <a tal:attributes="href view/groupInfo/url"
       tal:content="groupName">the group</a>.
    There <tal:block replace="python:singular and 'is' or 'are'"/>
    <strong>
      <tal:block replace="np"/> new
      <tal:block replace="python:singular and 'post' or 'posts'"/>
    </strong>
    <tal:block condition="python:nt or et">in </tal:block>
    <tal:block condition="nt">
      <tal:block replace="nt"/> new
      <tal:block replace="python:nt==1 and 'topic' or 'topics'"/>
    </tal:block>
    <tal:block condition="python:nt and et"> and</tal:block>
    <tal:block condition="et">
      <tal:block replace="et"/> existing
      <tal:block replace="python:et==1 and 'topic' or 'topics'"/>
    </tal:block>
    since yesterday:
  </p>
  <ul class="hfeed">
    <tal:block
      repeat="topic options/topicsDigest/topics | view/topicsDigest/topics | python:[]">
      <li class="hentry">
        <a href="#" class="topic"
           tal:attributes="href topic/topic_url"
           tal:content="topic/topic_subject">Topic Subject</a>
        <ul>
          <li>
            <strong><span tal:content="topic/num_posts_total">some</span> 
            posts</strong>
            &#8226;
            <span tal:content="topic/num_posts_today">some</span> posts since
            yesterday
            &#8226;
            Latest post by
            <span class="vcard fn"
                  tal:content="topic/last_post_author/name">author</span>
            at
            <span class="date published updated"
                  tal:define="d topic/last_post_date;
                              date python:munge_date(view.context, d);"
                  tal:content="date">date</span>
          </li>
          <li>
            <span class="muted">Keywords: </span>
            <span tal:content="python:', '.join(topic['keywords'])">word</span>
          </li>
        </ul>
      </li><!--hentry-->
    </tal:block>
  </ul><!--hfeed-->
  <p>
    <a href="#" tal:attributes="href view/groupInfo/url">
      Visit <span tal:content="view/groupInfo/name">this group</span></a>
      to start a new topic, make a post, or to find out more about this
      group.
  </p>
  <p>
    Kind regards,
  </p>
  <p>
    The <span tal:content="view/siteInfo/name">this group</span>
    team
  </p>
</tal:block>
